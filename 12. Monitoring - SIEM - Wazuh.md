Source: [Wazuh - Deployment on Docker](https://documentation.wazuh.com/current/deployment-options/docker/index.html)

# Benutze VM

> 192.168.100.10   centos

# Docker Anpassungen

Docker und Docker-Compose haben wir schon mit Greenbone implementiert, doch wir müssen die untere Anpassung vornehmen, um die Konfiguration zu optimieren und den Betrieb zu stabilisieren.

## Docker-Host 'centos' vorbereiten

Es wird empfohlen, den Docker-Host mit mindestens 6 GB Arbeitsspeicher zu konfigurieren. Abhängig von der Bereitstellung und Nutzung variiert der Speicherverbrauch des Wazuh Indexers. Daher sollte der empfohlene Speicher zugewiesen werden, damit eine vollständige Stack-Bereitstellung ordnungsgemäß funktioniert.

Erhöhe `vm.max_map_count` auf deinem Host (Linux):

Der Wazuh Indexer erstellt viele speicherabbildende Bereiche. Daher musst du den Kernel so einstellen, dass ein Prozess mindestens 262.144 speicherabbildende Bereiche erhält.

```bash
sudo sysctl -w vm.max_map_count=262144
```

Aktualisiere die Einstellung `vm.max_map_count` in der Datei `/etc/sysctl.conf`, um den Wert dauerhaft festzulegen. Um dies nach einem Neustart zu überprüfen, führe den Befehl `sysctl vm.max_map_count` aus.

```bash
echo 'vm.max_map_count = 262144' | sudo tee -a /etc/sysctl.conf
```

> **Warnung**: Wenn du `vm.max_map_count` auf deinem Host nicht setzt, wird der Wazuh Indexer NICHT richtig funktionieren.

# Wazuh Docker-Bereitstellung

## Einzelknoten-Bereitstellung

Klone das Wazuh-Repository auf dein System:  

```bash
git clone https://github.com/wazuh/wazuh-docker.git -b v4.9.2
```  

Wechsle anschließend in das Verzeichnis `single-node`, um alle nachfolgend beschriebenen Befehle innerhalb dieses Verzeichnisses auszuführen.  

Stelle für jeden Knoten im Stack eine Gruppe von Zertifikaten bereit, um die Kommunikation zwischen den Knoten abzusichern. Du hast zwei Möglichkeiten, diese Zertifikate bereitzustellen:  

1. **Selbstsignierte Zertifikate** für jeden Cluster-Knoten generieren.  
2. Verwende ein Docker-Image, das wir erstellt haben, um die Zertifikatsgenerierung mithilfe des Tools `Wazuh certs gen` zu automatisieren.  

Falls dein System einen Proxy verwendet, füge das Folgende in die Datei `generate-indexer-certs.yml` ein. Falls nicht, überspringe diesen Schritt:  

```yaml
environment:
  - HTTP_PROXY=YOUR_PROXY_ADDRESS_OR_DNS
```  

Ein vollständiges Beispiel sieht so aus:  




