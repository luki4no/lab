# Voraussetzungen

Du kannst einen PXE (Preboot Execution Environment) Server auf pfSense einrichten, obwohl es keine integrierte Funktion dafür gibt. Um dies zu erreichen, musst du in der Regel zusätzliche Tools oder Pakete verwenden, um den PXE-Bootprozess zu ermöglichen. Hier ist eine allgemeine Anleitung, wie du das einrichten kannst:

### Schritte zum Einrichten von PXE auf pfSense

1. **DHCP-Server auf pfSense aktivieren** (haben wir schon):
   - Gehe zu **Services > DHCP Server**.
   - Aktiviere den DHCP-Server für die Schnittstelle, die du verwenden möchtest (normalerweise die LAN-Schnittstelle).
   - Konfiguriere die DHCP-Einstellungen, einschließlich des IP-Adressbereichs und anderer Optionen.

```plaintext
webConfigurator http://192.168.100.2/
Services > DHCP Server > LAN
```
- [x] Enable DHCP server on LAN interface
- Address Pool Range: 192.168.100.100 - 192.168.100.200
---
2. **DHCP-Optionen für PXE konfigurieren** (brauchen wir):
   - Finde im DHCP-Serverbereich den Abschnitt **DHCP Static Mappings**, um die statischen IPs für deine PXE-Clients zu definieren, falls nötig.
   - Setze die DHCP-Optionen für PXE:
     - **Option 66**: Dies sollte auf die IP-Adresse deines TFTP-Servers (wo die PXE-Bootdateien bereitgestellt werden) zeigen.
     - **Option 67**: Dies gibt den Boot-Dateinamen an, typischerweise etwas wie `pxelinux.0`.

```plaintext
webConfigurator http://192.168.100.2/
Services > DHCP Server > LAN
```
- Other DHCP Options
  - Custom DHCP Options: Display Advanced
     - Custom Option Number: 66
     - Custom Option Type: IP address or host
     - Custom Option Value: 192.168.100.2
---
3. **TFTP-Server installieren** (brauchen wir)
   - Da pfSense keinen integrierten TFTP-Server hat, musst du einen TFTP-Server auf einem anderen Gerät (z. B. einer Linux-VM) in deinem Netzwerk installieren.
   - Stelle sicher, dass der TFTP-Server so konfiguriert ist, dass die notwendigen PXE-Bootdateien bereitgestellt werden, wie z. B. `pxelinux.0`, Kernel-Images und Initrd-Dateien.

```plaintext
webConfigurator http://192.168.100.2/
System > Package Manager > Available Packages
```

1. Search term: tftpd
2. +Install
3. Confirm
---
4. **PXE-Bootdateien vorbereiten** (brauchen wir):
   - Lege die notwendigen PXE-Bootdateien im TFTP-Stammverzeichnis deines TFTP-Servers ab. Dazu gehören typischerweise:
     - `pxelinux.0` (von syslinux)
     - Eine Konfigurationsdatei für den PXE-Boot (z. B. `pxelinux.cfg/default`)
     - Kernel-Images und Initrd-Dateien für die Betriebssysteme, die du bereitstellen möchtest.
---
5. **PXE-Boot testen** (brauchen wir):
   - Starte einen Client-Computer, der PXE unterstützt.
   - Stelle sicher, dass er so konfiguriert ist, dass er zuerst vom Netzwerk bootet.
   - Der Client sollte eine IP-Adresse vom pfSense-DHCP-Server erhalten und sich mit dem TFTP-Server verbinden, um die Bootdateien herunterzuladen.
---
### Zusätzliche Überlegungen:
- **Firewall-Regeln**: Stelle sicher, dass die Firewall-Regeln von pfSense DHCP- und TFTP-Verkehr erlauben. Möglicherweise musst du Regeln erstellen, um den UDP-Verkehr auf den Ports 67 (DHCP) und 69 (TFTP) zuzulassen.
- **Leistung**: Für Produktionsumgebungen solltest du in Betracht ziehen, einen dedizierten TFTP-Server für eine bessere Leistung und Verwaltung zu verwenden.
- **Dokumentation**: Konsultiere die pfSense-Dokumentation für spezifische Konfigurationsdetails oder Fehlersuche.

Wenn du diese Schritte befolgst, solltest du in der Lage sein, einen PXE-Server mithilfe von pfSense in deiner Netzwerkumgebung einzurichten.

# Was wir schon haben

## 1. DHCP-Server auf pfSense aktivieren

```plaintext
webConfigurator http://192.168.100.2/
Services > DHCP Server > LAN
```
- [x] Enable DHCP server on LAN interface
- Address Pool Range: 192.168.100.100 - 192.168.100.200

# Was wir noch brauchen

- [ ] 2. DHCP-Optionen für PXE konfigurieren
- [ ] 3. TFTP-Server installieren
- [ ] 4. PXE-Bootdateien vorbereiten
- [ ] 5. PXE-Boot testen

## 2. DHCP-Optionen für PXE konfigurieren

```plaintext
webConfigurator http://192.168.100.2/
Services > DHCP Server > LAN
```
- Other DHCP Options
  - Custom DHCP Options: Display Advanced
     - Custom Option Number: 66
     - Custom Option Type: IP address or host
     - Custom Option Value: 192.168.100.2

## 3. TFTP-Server installieren

Die Erweiterung 'tftpd' installieren:

```plaintext
webConfigurator http://192.168.100.2/
System > Package Manager > Available Packages
```

1. Search term: tftpd
2. +Install
3. Confirm





