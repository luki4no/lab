# Abschwächung von Sicherheitsangriffen mit Ansible

Um einen konsistenten Zustand auf allen Maschinen in dieser Umgebung zu gewährleisten, automatisieren wir den Hardening-Prozess mit Ansible.

## **Patching**  
- **Super wichtig**  
  - Systemstabilität und Sicherheitsfixes  
- **Monatliche Updates**  
  - Inkrementell (und wichtig)  
- **Drittanbieter-Updates**  
  - Anwendungsentwickler, Gerätetreiber  
- **Automatische Updates**  
  - Nicht immer die beste Wahl  
- **Notfall-Updates außerhalb des Plans**  
  - Zero-Day-Lücken und wichtige Sicherheitsprobleme  

```yml
- name: System aktualisieren und patchen
  hosts: all
  tasks:
    - name: Updates installieren
      apt:
        update_cache: yes
        upgrade: dist
      when: ansible_os_family == "Debian"
    - name: Updates installieren (Red Hat)
      yum:
        name: "*"
        state: latest
      when: ansible_os_family == "RedHat"
```

---

## **Verschlüsselung**  
- **Zugriff auf Anwendungsdaten blockieren**  
  - Dateisystemverschlüsselung  
- **Verschlüsselung der gesamten Festplatte (FDE)**  
  - Alles auf der Festplatte verschlüsseln  
  - BitLocker, FileVault usw.  
- **Dateiebene-Verschlüsselung**  
  - Windows EFS  
- **Anwendungsdatenverschlüsselung**  
  - Von der App verwaltet  
  - Gespeicherte Daten sind geschützt  

```yml
- name: Festplattenverschlüsselung einrichten
  hosts: all
  tasks:
    - name: LUKS Verschlüsselung aktivieren
      command: cryptsetup luksFormat /dev/sdb
```
---

## **Überwachung**  
- **Infos von Geräten sammeln**  
  - Eingebaute Sensoren, externe Geräte  
  - In Server, Switches, Router, Firewalls usw. integriert  
- **Sensoren**  
  - Intrusion-Prevention-Systeme, Firewall-Logs,  
    Authentifizierungsprotokolle, Webserver-Zugriffslogs,  
    Datenbanktransaktionslogs, E-Mail-Logs  
- **Sammelstellen**  
  - Proprietäre Konsolen (IPS, Firewall)  
  - SIEM-Konsolen, Syslog-Server  
  - Viele SIEM-Systeme haben Engines, die Sensordaten vergleichen  

```yml
- name: SIEM-Agent installieren
  hosts: all
  tasks:
    - name: Elastic Agent installieren
      apt:
        name: elastic-agent
        state: latest
      when: ansible_os_family == "Debian"
```
---

## **Minimalprinzip (Least Privilege)**  
- **Rechte und Berechtigungen aufs Minimum setzen**  
  - Jeder bekommt nur das, was er zum Arbeiten braucht  
- **Alle Benutzerkonten müssen eingeschränkt sein**  
  - Apps sollten mit minimalen Rechten laufen  
- **Keine Admin-Rechte für Benutzer**  
  - Begrenzt den Schaden, den Angriffe anrichten können  

```yml
- name: Berechtigungen einschränken
  hosts: all
  tasks:
    - name: Benutzer zu einer Gruppe hinzufügen
      user:
        name: "user1"
        groups: "limited"
        append: yes
```
---

## **Konfigurationsdurchsetzung**  
- **Geräte überprüfen**  
  - Jedes Mal, wenn ein Gerät verbunden wird  
- **Umfassende Checks**  
  - OS-Patch-Version  
  - Endpoint Detection and Response (EDR)-Version  
  - Status von Firewall und EDR  
  - Zertifikatstatus  
- **Nicht-konforme Systeme isolieren**  
  - Privates VLAN mit eingeschränktem Zugang  
  - Nach Korrekturen erneut prüfen  

```yml
- name: Sicherheitsrichtlinien durchsetzen
  hosts: all
  tasks:
    - name: Firewall aktivieren
      service:
        name: ufw
        state: started
        enabled: yes
```
---

## **Stilllegung (Decommissioning)**  
- **Sollte eine klare Regelung haben**  
  - Schmeiß deine Daten nicht einfach in den Müll  
  - Jemand könnte die später finden  
- **Meist bei Speichermedien relevant**  
  - Festplatten, SSDs, USB-Sticks  
- **Optionen für physische Geräte**  
  - Gerät recyceln und woanders verwenden  
  - Gerät zerstören  

```yml
- name: Daten sicher löschen
  hosts: all
  tasks:
    - name: Festplatte sicher löschen
      command: shred -n 3 -v /dev/sdb
```
---

## **System-Hardening**  
- **Vielfältige Maßnahmen**  
  - Windows, Linux, iOS, Android und andere  
- **Updates**  
  - Betriebssystem-Updates/Service-Packs, Sicherheits-Patches  
- **Benutzerkonten**  
  - Mindestanforderungen an Passwortlänge und -komplexität  
  - Einschränkungen für Benutzerkonten  
- **Netzwerkzugang und Sicherheit**  
  - Netzwerkzugang begrenzen  
- **Überwachen und absichern**  
  - Anti-Virus, Anti-Malware

